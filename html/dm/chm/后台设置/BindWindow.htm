<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="BindWindow.files/filelist.xml">
<title>无标题文档</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>User</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>User</o:LastAuthor>
  <o:Revision>310</o:Revision>
  <o:TotalTime>187</o:TotalTime>
  <o:Created>2010-05-27T13:54:00Z</o:Created>
  <o:LastSaved>2018-06-06T15:30:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>597</o:Words>
  <o:Characters>3406</o:Characters>
  <o:Company>Microsoft</o:Company>
  <o:Lines>28</o:Lines>
  <o:Paragraphs>7</o:Paragraphs>
  <o:CharactersWithSpaces>3996</o:CharactersWithSpaces>
  <o:Version>11.6568</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
p.style1, li.style1, div.style1
	{mso-style-name:style1;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;
	color:blue;
	font-weight:bold;}
span.style11
	{mso-style-name:style11;
	color:blue;
	font-weight:bold;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:810555742;
	mso-list-type:hybrid;
	mso-list-template-ids:229441040 912134324 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l0:level1
	{mso-level-tab-stop:20.25pt;
	mso-level-number-position:left;
	margin-left:20.25pt;
	text-indent:-20.25pt;}
@list l0:level2
	{mso-level-tab-stop:72.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level3
	{mso-level-tab-stop:108.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level4
	{mso-level-tab-stop:144.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level5
	{mso-level-tab-stop:180.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level6
	{mso-level-tab-stop:216.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level7
	{mso-level-tab-stop:252.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level8
	{mso-level-tab-stop:288.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level9
	{mso-level-tab-stop:324.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:普通表格;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
</head>

<body lang=ZH-CN link=blue vlink=purple style='tab-interval:21.0pt'>

<div class=Section1>

<p class=style1><span style='font-size:13.5pt'>函数简介<span lang=EN-US>:<o:p></o:p></span></span></p>

<p><span style='font-size:13.5pt'>绑定指定的窗口<span lang=EN-US>,</span>并指定这个窗口的屏幕颜色获取方式<span
lang=EN-US>,</span>鼠标仿真模式<span lang=EN-US>,</span>键盘仿真模式<span lang=EN-US>,</span>以及模式设定<span
lang=EN-US>,</span><span style='color:red'>高级用户可以参考<span lang=EN-US><a
href="BindWindowEx.htm">BindWindowEx</a></span>更加灵活强大<span lang=EN-US>.</span></span><span
lang=EN-US><o:p></o:p></span></span></p>

<p><span class=style11><span style='font-size:13.5pt'>函数原型<span lang=EN-US>:</span></span></span><span
lang=EN-US style='font-size:13.5pt'><br>
<br>
long BindWindow(hwnd,display,mouse,keypad,mode)<o:p></o:p></span></p>

<p><span class=style11><span style='font-size:13.5pt'>参数定义<span lang=EN-US>:</span></span></span><span
lang=EN-US style='font-size:13.5pt'><br>
<br>
<span style='color:green'>hwnd </span></span><span style='font-size:13.5pt;
color:maroon'>整形数</span><span lang=EN-US style='font-size:13.5pt;color:green'>:
</span><span style='font-size:13.5pt;color:green'>指定的窗口句柄</span><span
lang=EN-US style='font-size:13.5pt'><br>
<br>
<span style='color:green'>display </span></span><span style='font-size:13.5pt;
color:gray'>字符串</span><span lang=EN-US style='font-size:13.5pt;color:green'>: </span><span
style='font-size:13.5pt;color:green'>屏幕颜色获取方式 取值有以下几种</span><span lang=EN-US
style='font-size:13.5pt'><br>
<br>
&quot;normal&quot; : </span><span style='font-size:13.5pt'>正常模式<span
lang=EN-US>,</span>平常我们用的前台截屏模式<span lang=EN-US><br>
<br>
&quot;gdi&quot; : gdi</span>模式<span lang=EN-US>,</span>用于窗口采用<span lang=EN-US>GDI</span>方式刷新时<span
lang=EN-US>.<span style='color:red'> </span></span><span style='color:red'>此模式占用<span
lang=EN-US>CPU</span>较大<span lang=EN-US>. </span>参考<span lang=EN-US><a
href="SetAero.htm">SetAero</a><span style='mso-spacerun:yes'>&nbsp;
</span>win10</span>以上系统使用此模式，如果截图失败，尝试把目标程序重新开启再试试。</span><span lang=EN-US><o:p></o:p></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>&quot;gdi2&quot; : gdi2</span><span
style='font-size:13.5pt'>模式<span lang=EN-US>,</span>此模式兼容性较强<span lang=EN-US>,</span>但是速度比<span
lang=EN-US>gdi</span>模式要慢许多<span lang=EN-US>,</span>如果<span lang=EN-US>gdi</span>模式发现后台不刷新时<span
lang=EN-US>,</span>可以考虑用<span lang=EN-US>gdi2</span>模式<span lang=EN-US>.<br>
<br>
&quot;dx2&quot; : dx2</span>模式<span lang=EN-US>,</span>用于窗口采用<span lang=EN-US>dx</span>模式刷新<span
lang=EN-US>,</span>如果<span lang=EN-US>dx</span>方式会出现窗口所在进程崩溃的状况<span
lang=EN-US>,</span>可以考虑采用这种<span lang=EN-US>.</span>采用这种方式要保证窗口有一部分在屏幕外<span
lang=EN-US>.win7 win8</span>或者<span lang=EN-US>vista</span>不需要移动也可后台<span
lang=EN-US>.</span><span style='color:red'>此模式占用<span lang=EN-US>CPU</span>较大<span
lang=EN-US>. </span>参考<span lang=EN-US><a href="SetAero.htm">SetAero</a>. <a
href="../常见问题/WIN8以上系统dx2%20gdi失效解决办法.htm"><span
style='mso-spacerun:yes'>&nbsp;</span></a><span
style='mso-spacerun:yes'>&nbsp;</span>win10</span>以上系统使用此模式，如果截图失败，尝试把目标程序重新开启再试试。<span
lang=EN-US><o:p></o:p></span></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>&quot;dx3&quot; : dx3</span><span
style='font-size:13.5pt'>模式<span lang=EN-US>,</span>同<span lang=EN-US>dx2</span>模式<span
lang=EN-US>,</span>但是如果发现有些窗口后台不刷新时<span lang=EN-US>,</span>可以考虑用<span
lang=EN-US>dx3</span>模式<span lang=EN-US>,</span>此模式比<span lang=EN-US>dx2</span>模式慢许多<span
lang=EN-US>.<span style='color:red'> </span></span><span style='color:red'>此模式占用<span
lang=EN-US>CPU</span>较大<span lang=EN-US>. </span>参考<span lang=EN-US><a
href="SetAero.htm">SetAero</a></span></span><span lang=EN-US>. <span
style='color:red'>win10</span></span><span style='color:red'>以上系统使用此模式，如果截图失败，尝试把目标程序重新开启再试试。</span><span
lang=EN-US><o:p></o:p></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>&quot;dx&quot; : dx</span><span
style='font-size:13.5pt'>模式<span lang=EN-US>,</span>等同于<span lang=EN-US>BindWindowEx</span>中，<span
lang=EN-US>display</span>设置的<span lang=EN-US style='color:red'>&quot;dx.graphic.2d|dx.graphic.3d&quot;</span><span
lang=EN-US>,</span>具体参考<span lang=EN-US>BindWindowEx<br>
<br>
<br>
<span style='color:green'>mouse </span></span><span style='color:gray'>字符串</span><span
lang=EN-US style='color:green'>: </span><span style='color:green'>鼠标仿真模式 取值有以下几种</span><span
lang=EN-US><br>
<br>
&quot;normal&quot; : </span>正常模式<span lang=EN-US>,</span>平常我们用的前台鼠标模式<span
lang=EN-US><br>
<br>
&quot;windows&quot;: Windows</span>模式<span lang=EN-US>,</span>采取模拟<span
lang=EN-US>windows</span>消息方式 同按键自带后台插件<span lang=EN-US>.<o:p></o:p></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>&quot;windows2&quot;: Windows2 </span><span
style='font-size:13.5pt'>模式<span lang=EN-US>,</span>采取模拟<span lang=EN-US>windows</span>消息方式<span
lang=EN-US>(</span>锁定鼠标位置<span lang=EN-US>) </span>此模式等同于<span lang=EN-US>BindWindowEx</span>中的<span
lang=EN-US>mouse</span>为以下组合<span lang=EN-US><br>
<span style='color:red'>&quot;dx.mouse.position.lock.api|dx.mouse.position.lock.message|dx.mouse.state.message&quot;<br
style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>&quot;windows3&quot;: Windows3</span><span
style='font-size:13.5pt'>模式，采取模拟<span lang=EN-US>windows</span>消息方式<span
lang=EN-US>,</span>可以支持有多个子窗口的窗口后台<span lang=EN-US>.<br>
<br>
&quot;dx&quot;: dx</span>模式<span lang=EN-US>,</span>采用模拟<span lang=EN-US>dx</span>后台鼠标模式<span
lang=EN-US>,</span>这种方式会锁定鼠标输入<span lang=EN-US>.</span>有些窗口在此模式下绑定时，需要先激活窗口再绑定<span
lang=EN-US>(</span>或者绑定以后激活<span lang=EN-US>)</span>，否则可能会出现绑定后鼠标无效的情况<span
lang=EN-US>.</span>此模式等同于<span lang=EN-US>BindWindowEx</span>中的<span
lang=EN-US>mouse</span>为以下组合<span lang=EN-US><br>
<span style='color:red'>&quot;dx.public.active.api|dx.public.active.message|dx.mouse.position.lock.api|dx.mouse.position.lock.message|dx.mouse.state.api|dx.mouse.state.message|dx.mouse.api|dx.mouse.focus.input.api|dx.mouse.focus.input.message|dx.mouse.clip.lock.api|dx.mouse.input.lock.api|dx.mouse.cursor&quot;<br
style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]></span><o:p></o:p></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>&quot;dx2&quot;</span><span
style='font-size:13.5pt'>：<span lang=EN-US>dx2</span>模式<span lang=EN-US>,</span>这种方式类似于<span
lang=EN-US>dx</span>模式<span lang=EN-US>,</span>但是不会锁定外部鼠标输入<span lang=EN-US>.<br>
</span>有些窗口在此模式下绑定时，需要先激活窗口再绑定<span lang=EN-US>(</span>或者绑定以后手动激活<span
lang=EN-US>)</span>，否则可能会出现绑定后鼠标无效的情况<span lang=EN-US>. </span>此模式等同于<span
lang=EN-US>BindWindowEx</span>中的<span lang=EN-US>mouse</span>为以下组合<span
lang=EN-US><br>
<span style='color:red'>&quot;dx.public.active.api|dx.public.active.message|dx.mouse.position.lock.api|dx.mouse.state.api|dx.mouse.api|dx.mouse.focus.input.api|dx.mouse.focus.input.message|dx.mouse.clip.lock.api|dx.mouse.input.lock.api|
dx.mouse.cursor&quot;<br>
</span><br>
<br>
<span style='color:green'>keypad </span></span><span style='color:gray'>字符串</span><span
lang=EN-US style='color:green'>: </span><span style='color:green'>键盘仿真模式 取值有以下几种</span><span
lang=EN-US><br>
<br>
&quot;normal&quot; : </span>正常模式<span lang=EN-US>,</span>平常我们用的前台键盘模式<span
lang=EN-US><br>
<br>
&quot;windows&quot;: Windows</span>模式<span lang=EN-US>,</span>采取模拟<span
lang=EN-US>windows</span>消息方式 同按键的后台插件<span lang=EN-US>.<br>
<br>
&quot;dx&quot;: dx</span>模式<span lang=EN-US>,</span>采用模拟<span lang=EN-US>dx</span>后台键盘模式。有些窗口在此模式下绑定时，需要先激活窗口再绑定<span
lang=EN-US>(</span>或者绑定以后激活<span lang=EN-US>)</span>，否则可能会出现绑定后键盘无效的情况<span
lang=EN-US>. </span>此模式等同于<span lang=EN-US>BindWindowEx</span>中的<span
lang=EN-US>keypad</span>为以下组合<span lang=EN-US><br>
<span style='color:red'>&quot;dx.public.active.api|dx.public.active.message|</span></span></span><span
lang=EN-US style='color:red'> </span><span lang=EN-US style='font-size:13.5pt;
color:red'>dx.keypad.state.api|dx.keypad.api|dx.keypad.input.lock.api&quot;<br
style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]></span><span lang=EN-US style='font-size:13.5pt'><o:p></o:p></span></p>

<p><span lang=EN-US style='font-size:13.5pt;color:red'><o:p>&nbsp;</o:p></span></p>

<p style='text-align:justify;text-justify:inter-ideograph'><span lang=EN-US
style='font-size:13.5pt;color:green'>mode </span><span style='font-size:13.5pt;
color:maroon'>整形数</span><span lang=EN-US style='font-size:13.5pt;color:green'>:
</span><span style='font-size:13.5pt;color:green'>模式。 取值有以下几种<span lang=EN-US><o:p></o:p></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='color:red'>0 : </span></span><span style='font-size:13.5pt;color:red'>推荐模式此模式比较通用，而且后台效果是最好的<span
lang=EN-US>.<o:p></o:p></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt;color:red'><span style='mso-tab-count:
1'>&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp; </span>2 : </span><span
style='font-size:13.5pt;color:red'>同模式<span lang=EN-US>0,</span>如果模式<span
lang=EN-US>0</span>有崩溃问题，可以尝试此模式<span lang=EN-US>. </span></span><span
style='font-size:13.5pt;color:fuchsia'>注意<span lang=EN-US>0</span>和<span
lang=EN-US>2</span>模式，当主绑定<span lang=EN-US>(</span>第一个绑定同个窗口的对象<span
lang=EN-US>)</span>绑定成功后，那么调用主绑定的线程必须一致维持<span lang=EN-US>,</span>否则线程一旦推出<span
lang=EN-US>,</span>对应的绑定也会消失<span lang=EN-US>.</span></span><span lang=EN-US
style='font-size:13.5pt;color:red'><o:p></o:p></span></p>

<p><span lang=EN-US style='font-size:13.5pt'><span style='mso-tab-count:1'>&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp; </span><span style='color:red'>101 : </span></span><span
style='font-size:13.5pt;color:red'>超级绑定模式<span lang=EN-US>. </span>可隐藏目标进程中的<span
lang=EN-US>dm.dll.</span>避免被恶意检测<span lang=EN-US>.</span>效果要比<span lang=EN-US>dx.public.hide.dll</span>好<span
lang=EN-US>. </span>推荐使用<span lang=EN-US>.<o:p></o:p></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt;color:red'><span style='mso-tab-count:
1'>&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp; </span>103 : </span><span
style='font-size:13.5pt;color:red'>同模式<span lang=EN-US>101</span>，如果模式<span
lang=EN-US>101</span>有崩溃问题，可以尝试此模式<span lang=EN-US>. <br>
<br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>11 : </span>需要加载驱动<span
lang=EN-US>,</span>适合一些特殊的窗口<span lang=EN-US>,</span>如果前面的无法绑定，可以尝试此模式<span
lang=EN-US>. </span>此模式不支持<span lang=EN-US>32</span>位系统<span lang=EN-US><br>
<br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>13 : </span>需要加载驱动<span
lang=EN-US>,</span>适合一些特殊的窗口<span lang=EN-US>,</span>如果前面的无法绑定，可以尝试此模式<span
lang=EN-US>. </span>此模式不支持<span lang=EN-US>32</span>位系统<span lang=EN-US><o:p></o:p></span></span></p>

<p><span style='font-size:13.5pt;color:fuchsia'>需要注意的是<span lang=EN-US>: </span>模式<span
lang=EN-US>101 103</span>在大部分窗口下绑定都没问题。但也有少数特殊的窗口，比如有很多子窗口的窗口，对于这种窗口，在绑定时，一定要把<span
lang=EN-US><br>
</span>鼠标指向一个可以输入文字的窗口，比如一个文本框，最好能激活这个文本框，这样可以保证绑定的成功<span lang=EN-US>.<o:p></o:p></span></span></p>

<p><span class=style11><span style='font-size:13.5pt'>返回值<span lang=EN-US>:</span></span></span><span
lang=EN-US style='font-size:13.5pt'><o:p></o:p></span></p>

<p><span style='font-size:13.5pt;color:maroon'>整形数<span lang=EN-US>:</span></span><span
lang=EN-US style='font-size:13.5pt'><br>
0: </span><span style='font-size:13.5pt'>失败<span lang=EN-US><br>
1: </span>成功<span lang=EN-US><br>
<br>
</span>如果返回<span lang=EN-US>0</span>，可以调用<span lang=EN-US><a
href="../基本设置/GetLastError.htm">GetLastError</a></span>来查看具体失败错误码<span
lang=EN-US>,</span>帮助分析问题<span lang=EN-US>.<o:p></o:p></span></span></p>

<p><span class=style11><span style='font-size:13.5pt'>示例<span lang=EN-US>:</span></span></span><span
lang=EN-US style='font-size:13.5pt'><o:p></o:p></span></p>

<p><span lang=EN-US style='font-size:13.5pt'><br>
// display: </span><span style='font-size:13.5pt'>前台 鼠标<span lang=EN-US>:</span>前台
键盘<span lang=EN-US>:</span>前台 模式<span lang=EN-US>0<br>
dm_ret =
dm.BindWindow(hwnd,&quot;normal&quot;,&quot;normal&quot;,&quot;normal&quot;,0)<o:p></o:p></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>// display: dx </span><span
style='font-size:13.5pt'>鼠标<span lang=EN-US>:</span>前台 键盘<span lang=EN-US>:</span>前台
模式<span lang=EN-US>0<br>
dm_ret =
dm.BindWindow(hwnd,&quot;dx&quot;,&quot;normal&quot;,&quot;normal&quot;,0)<o:p></o:p></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>// display: dx </span><span
style='font-size:13.5pt'>鼠标<span lang=EN-US>:dx </span>后台 键盘<span lang=EN-US>:
dx</span>后台 模式<span lang=EN-US>1<br>
dm_ret = dm.BindWindow(hwnd,&quot;dx&quot;,&quot;dx&quot;,&quot;dx&quot;,1) <o:p></o:p></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>// display: dx </span><span
style='font-size:13.5pt'>鼠标<span lang=EN-US>:windows3</span>后台 键盘<span
lang=EN-US>:windows</span>后台 模式<span lang=EN-US>101<br>
dm_ret = dm.BindWindow(hwnd,&quot;dx&quot;,&quot;windows3&quot;,&quot;windows&quot;,101)<o:p></o:p></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'><br>
</span><span class=style11><span style='font-size:13.5pt'>注意<span lang=EN-US>:</span></span></span><span
lang=EN-US style='font-size:13.5pt'><o:p></o:p></span></p>

<p><span lang=EN-US style='font-size:13.5pt'><br>
</span><span style='font-size:13.5pt'>绑定之后<span lang=EN-US>,</span>所有的坐标都相对于窗口的客户区坐标<span
lang=EN-US>(</span>不包含窗口边框<span lang=EN-US>)<br>
</span>另外<span lang=EN-US>,</span>绑定窗口后<span lang=EN-US>,</span>必须加以下代码<span
lang=EN-US>,</span>以保证所有资源正常释放<span lang=EN-US><o:p></o:p></span></span></p>

<p><span style='font-size:13.5pt'>这个函数的意思是在脚本结束时<span lang=EN-US>,</span>会调用这个函数。需要注意的是，目前的按键版本对于这个函数的执行不是线程级别的，也就是说，这个函数只会在主线程执行，子线程绑定的大漠对象，不保证完全释放。<span
lang=EN-US> <br>
Sub OnScriptExit()<br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>dm_ret =
dm.UnBindWindow() <br>
End Sub<o:p></o:p></span></span></p>

<p><span style='font-size:13.5pt'>另外 绑定<span lang=EN-US>dx</span>会比较耗时间<span
lang=EN-US>,</span>请不要频繁调用此函数<span lang=EN-US>.<o:p></o:p></span></span></p>

<p><span style='font-size:13.5pt'>还有一点特别要注意的是<span lang=EN-US>,</span>有些窗口绑定之后必须加一定的延时<span
lang=EN-US>,</span>否则后台也无效<span lang=EN-US>.</span>一般<span lang=EN-US>1</span>秒到<span
lang=EN-US>2</span>秒的延时就足够<span lang=EN-US>.<o:p></o:p></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'><o:p>&nbsp;</o:p></span></p>

<p><span style='font-size:13.5pt;color:red'>发现绑定失败的几种可能<span lang=EN-US>(</span>一般是需要管理员权限的模式才有可能会失败<span
lang=EN-US>)<o:p></o:p></span></span></p>

<p style='margin-left:20.25pt;text-indent:-20.25pt;mso-list:l0 level1 lfo2;
tab-stops:list 20.25pt'><![if !supportLists]><span lang=EN-US style='font-size:
13.5pt;color:red'><span style='mso-list:Ignore'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:13.5pt;color:red'>系统登录的帐号必须有<span
lang=EN-US>Administrators</span>权限<span lang=EN-US><o:p></o:p></span></span></p>

<p style='margin-left:20.25pt;text-indent:-20.25pt;mso-list:l0 level1 lfo2;
tab-stops:list 20.25pt'><![if !supportLists]><span lang=EN-US style='font-size:
13.5pt;color:red'><span style='mso-list:Ignore'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:13.5pt;color:red'>一些防火墙会防止插件注入窗口所在进程，比如<span
lang=EN-US>360</span>防火墙等，必须把<span lang=EN-US>dm.dll</span>设置为信任<span
lang=EN-US>.<o:p></o:p></span></span></p>

<p style='margin-left:20.25pt;text-indent:-20.25pt;mso-list:l0 level1 lfo2;
tab-stops:list 20.25pt'><![if !supportLists]><span lang=EN-US style='font-size:
13.5pt;color:red'><span style='mso-list:Ignore'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:13.5pt;color:red'>还有一个比较弱智的可能性，那就是插件没有注册到系统中，这时<span
lang=EN-US>CreateObject</span>压根就是失败的<span lang=EN-US>. </span>检测对象是否创建成功很简单，如下代码<span
lang=EN-US><br>
<br>
set dm = createobject(&quot;dm.dmsoft&quot;)<br>
ver = dm.Ver()<br>
If len(ver) = 0 Then<br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>MessageBox &quot;</span>创建对象失败<span
lang=EN-US>,</span>检查系统是否禁用了<span lang=EN-US>vbs</span>脚本权限<span lang=EN-US>&quot;<br>
<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>EndScript<br>
End If<o:p></o:p></span></span></p>

<p style='margin-left:21.0pt'><span lang=EN-US style='font-size:13.5pt;
color:red'><o:p>&nbsp;</o:p></span></p>

<p style='margin-left:20.25pt;text-indent:-20.25pt;mso-list:l0 level1 lfo2;
tab-stops:list 20.25pt'><![if !supportLists]><span lang=EN-US style='font-size:
13.5pt;color:red'><span style='mso-list:Ignore'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:13.5pt;color:red'>在沙盘中开的窗口进程，绑定一些需要管理员权限的模式，会失败。<span
lang=EN-US><br>
</span>解决方法是要配置沙盘参数，具体如何配置参考沙盘绑定方法<span lang=EN-US>.<br style='mso-special-character:
line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></span></p>

<p style='margin-left:20.25pt;text-indent:-20.25pt;mso-list:l0 level1 lfo2;
tab-stops:list 20.25pt'><![if !supportLists]><span lang=EN-US style='font-size:
13.5pt;color:red'><span style='mso-list:Ignore'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:13.5pt;color:red'>窗口所在进程有保护，这个我也无能为力<span
lang=EN-US>.<o:p></o:p></span></span></p>

</div>

</body>

</html>
