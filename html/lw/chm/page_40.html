<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML xmlns:o = "urn:schemas-microsoft-com:office:office" xmlns:st1 = 
"urn:schemas-microsoft-com:office:smarttags"><HEAD><TITLE>Ocr</TITLE>
<META content="text/html; charset=gb2312" http-equiv=Content-Type>
<META name=GENERATOR content="MSHTML 8.00.7600.17267"><LINK rel=stylesheet 
href="_template.css"></HEAD>
<BODY>
<DIV id=nsbanner>
<DIV id=bannerrow1>
<TABLE class=bannerparthead>
  <TBODY>
  <TR id=hdr>
    <TD class=runninghead noWrap>乐玩插件接口说明 v7.27111</TD></TR></TBODY></TABLE></DIV>
<DIV id=titlerow>
<H1 class=dtH1>Ocr</H1></DIV></DIV>
<DIV id=nstext><BR>
<DIV class=Section1><SPAN style="FONT-SIZE: 13.5pt">
<P class=style1><SPAN style="FONT-SIZE: 13.5pt"><FONT 
color=#0000ff><STRONG>函数简介<SPAN 
lang=EN-US>:<o:p></o:p></SPAN></STRONG></FONT></SPAN></P>
<P class=style1></SPAN><SPAN style="FONT-SIZE: 13.5pt">识别屏幕范围<SPAN 
lang=EN-US>(x1,y1,x2,y2)</SPAN>内符合<SPAN lang=EN-US>color_format</SPAN>的字符串<SPAN 
lang=EN-US>,</SPAN>并且相似度为<SPAN lang=EN-US>sim,sim</SPAN>取值范围<SPAN 
lang=EN-US>(0.1-1.0),<o:p></o:p></SPAN></SPAN></P>
<P><SPAN style="FONT-SIZE: 13.5pt">这个值越大越精确<SPAN lang=EN-US>,</SPAN>越大速度越快<SPAN 
lang=EN-US>,</SPAN>越小速度越慢<SPAN lang=EN-US>,</SPAN>请斟酌使用<SPAN 
lang=EN-US>!<o:p></o:p></SPAN></SPAN></P>
<P><SPAN class=style11><SPAN style="FONT-SIZE: 13.5pt"><STRONG><FONT 
color=#0000ff>函数原型<SPAN lang=EN-US>:</SPAN></FONT></STRONG></SPAN></SPAN><SPAN 
style="FONT-SIZE: 13.5pt" lang=EN-US><BR><BR>string 
Ocr(x1,y1,x2,y2,color_format,sim,linesign,isbackcolor)<o:p></o:p></SPAN></P>
<P><SPAN class=style11><SPAN style="FONT-SIZE: 13.5pt"><STRONG><FONT 
color=#0000ff>参数定义<SPAN lang=EN-US>:</SPAN></FONT></STRONG></SPAN></SPAN><SPAN 
style="FONT-SIZE: 13.5pt" lang=EN-US><BR><BR>x1 </SPAN><SPAN 
style="COLOR: maroon; FONT-SIZE: 13.5pt">整形数</SPAN><SPAN 
style="FONT-SIZE: 13.5pt" lang=EN-US>:</SPAN><SPAN 
style="FONT-SIZE: 13.5pt">区域的左上<SPAN lang=EN-US>X</SPAN>坐标<SPAN 
lang=EN-US><BR>y1 </SPAN><SPAN style="COLOR: maroon">整形数</SPAN><SPAN 
lang=EN-US>:</SPAN>区域的左上<SPAN lang=EN-US>Y</SPAN>坐标<SPAN lang=EN-US><BR>x2 
</SPAN><SPAN style="COLOR: maroon">整形数</SPAN><SPAN lang=EN-US>:</SPAN>区域的右下<SPAN 
lang=EN-US>X</SPAN>坐标<SPAN lang=EN-US><BR>y2 </SPAN><SPAN 
style="COLOR: maroon">整形数</SPAN><SPAN lang=EN-US>:</SPAN>区域的右下<SPAN 
lang=EN-US>Y</SPAN>坐标<SPAN lang=EN-US><BR>color_format </SPAN><SPAN 
style="COLOR: gray">字符串</SPAN><SPAN lang=EN-US>:</SPAN>颜色格式串,有两种格式：</SPAN></P>
<P><SPAN style="FONT-SIZE: 13.5pt"></SPAN><SPAN 
style="FONT-SIZE: 13.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
1，直接写RGB色加-RGB色偏，如“9f2e3f-030303|2d3f2f-000000"，支持多个。</SPAN></P>
<P><SPAN 
style="FONT-SIZE: 13.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2，#后面加数值，如“#128”，表示采用灰度阀值二值化，值的取值范围为-6到510，只能设置1个。<SPAN 
style="FONT-SIZE: 13.5pt">具体可用工具测试。</SPAN></P></SPAN>
<P><SPAN style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US>sim </SPAN><SPAN 
style="COLOR: #339966"><SPAN style="COLOR: #339966">小数型</SPAN></SPAN><SPAN 
lang=EN-US>:</SPAN>相似度<SPAN lang=EN-US>,</SPAN>取值范围<SPAN 
lang=EN-US>0.1-1.0　　<FONT color=#ff0000>此参数的缺省值为0.95</FONT></SPAN></SPAN></P>
<P><SPAN style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US><o:p>linesign&nbsp; <FONT 
color=#800000>文本型</FONT> :换行标志,表示如果碰到换行,<FONT 
color=#ff0000>用什么代替换行符,此参数的缺省值为一个空文本.</FONT></o:p></SPAN></SPAN></P>
<P><SPAN style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US><o:p><FONT 
color=#ff0000><FONT color=#000000>isbackcolor<FONT color=#800000> 
整数型</FONT>:是否采用背景色识字</FONT>,</FONT><FONT color=#000000>1=</FONT><FONT 
color=#000000>color_format 参数所提供的颜色为背景色,其它值表示提供的是文本颜色,</FONT><FONT 
color=#ff0000>该参数缺省值为0.</FONT></o:p></SPAN></SPAN></P>
<P><STRONG><FONT color=#0000ff><SPAN class=style11><SPAN 
style="FONT-SIZE: 13.5pt">返回值<SPAN lang=EN-US>:</SPAN></SPAN></SPAN><SPAN 
style="FONT-SIZE: 13.5pt" lang=EN-US><o:p></o:p></SPAN></FONT></STRONG></P>
<P><SPAN style="COLOR: gray; FONT-SIZE: 13.5pt">字符串<SPAN 
lang=EN-US>:</SPAN></SPAN><SPAN style="FONT-SIZE: 13.5pt" 
lang=EN-US><BR></SPAN><SPAN style="FONT-SIZE: 13.5pt">返回识别到的字符串<SPAN 
lang=EN-US><o:p></o:p></SPAN></SPAN></P>
<P><STRONG><FONT color=#0000ff><SPAN class=style11><SPAN 
style="FONT-SIZE: 13.5pt">示例<SPAN lang=EN-US>:</SPAN></SPAN></SPAN><SPAN 
style="FONT-SIZE: 13.5pt" lang=EN-US><o:p></o:p></SPAN></FONT></STRONG></P>
<P><SPAN style="FONT-SIZE: 13.5pt" lang=EN-US>//阀值识别</SPAN></P>
<P><SPAN style="FONT-SIZE: 13.5pt" lang=EN-US>s = 
lw.Ocr(0,0,2000,2000,"<st1:chmetcnv w:st="on" TCSC="0" NumberType="1" 
Negative="False" HasSpace="False" SourceValue="9" 
UnitName="F">#128</st1:chmetcnv>",1.0)<BR>MessageBox s</SPAN></P><SPAN 
style="FONT-SIZE: 13.5pt" lang=EN-US><o:p></o:p>
<P><BR>//RGB</SPAN><SPAN style="FONT-SIZE: 13.5pt">单色识别<SPAN lang=EN-US><BR>s = 
lw.Ocr(0,0,2000,2000,"<st1:chmetcnv w:st="on" TCSC="0" NumberType="1" 
Negative="False" HasSpace="False" SourceValue="9" 
UnitName="F">9f</st1:chmetcnv>2e<st1:chmetcnv w:st="on" TCSC="0" NumberType="1" 
Negative="False" HasSpace="False" SourceValue="3" 
UnitName="F">3f</st1:chmetcnv>-000000",1.0)<BR>MessageBox s</SPAN></SPAN></P>
<P><SPAN style="FONT-SIZE: 13.5pt"><SPAN 
lang=EN-US><o:p></o:p></SPAN></SPAN>&nbsp;</P>
<P><SPAN style="FONT-SIZE: 13.5pt" lang=EN-US>//RGB</SPAN><SPAN 
style="FONT-SIZE: 13.5pt">单色差色识别<SPAN lang=EN-US><BR>s = 
lw.Ocr(0,0,2000,2000,"<st1:chmetcnv w:st="on" TCSC="0" NumberType="1" 
Negative="False" HasSpace="False" SourceValue="9" 
UnitName="F">9f</st1:chmetcnv>2e<st1:chmetcnv w:st="on" TCSC="0" NumberType="1" 
Negative="False" HasSpace="False" SourceValue="3" 
UnitName="F">3f</st1:chmetcnv>-030303",1.0)<BR>MessageBox s</SPAN></SPAN></P>
<P><SPAN style="FONT-SIZE: 13.5pt"><SPAN 
lang=EN-US><o:p></o:p></SPAN></SPAN>&nbsp;</P>
<P><SPAN style="FONT-SIZE: 13.5pt" lang=EN-US>//RGB</SPAN><SPAN 
style="FONT-SIZE: 13.5pt">多色识别<SPAN lang=EN-US>(</SPAN>每种颜色用<SPAN 
lang=EN-US>"|"</SPAN>分割,个数无限制<SPAN lang=EN-US>)<BR>s = 
lw.Ocr(0,0,2000,2000,"<st1:chmetcnv w:st="on" TCSC="0" NumberType="1" 
Negative="False" HasSpace="False" SourceValue="9" 
UnitName="F">9f</st1:chmetcnv>2e<st1:chmetcnv w:st="on" TCSC="0" NumberType="1" 
Negative="False" HasSpace="False" SourceValue="3" 
UnitName="F">3f</st1:chmetcnv>-030303|2d<st1:chmetcnv w:st="on" TCSC="0" 
NumberType="1" Negative="False" HasSpace="False" SourceValue="3" 
UnitName="F">3f</st1:chmetcnv><st1:chmetcnv w:st="on" TCSC="0" NumberType="1" 
Negative="False" HasSpace="False" SourceValue="2" 
UnitName="F">2f</st1:chmetcnv>-000000|<st1:chmetcnv w:st="on" TCSC="0" 
NumberType="1" Negative="False" HasSpace="False" SourceValue="3" 
UnitName="F">3f</st1:chmetcnv>9e4d-100000",1.0)<BR>MessageBox 
s<o:p></o:p></SPAN></SPAN></P>
<P><SPAN style="FONT-SIZE: 13.5pt" lang=EN-US></SPAN>&nbsp;</P>
<P><SPAN style="FONT-SIZE: 13.5pt" lang=EN-US>//</SPAN><SPAN 
style="FONT-SIZE: 13.5pt">比如用回车换行分割<SPAN lang=EN-US><BR>s = 
lw.Ocr(0,0,2000,2000,"<st1:chmetcnv w:st="on" TCSC="0" NumberType="1" 
Negative="False" HasSpace="False" SourceValue="9" 
UnitName="F">9f</st1:chmetcnv>2e<st1:chmetcnv w:st="on" TCSC="0" NumberType="1" 
Negative="False" HasSpace="False" SourceValue="3" 
UnitName="F">3f</st1:chmetcnv>-000000,",0.95,vbcrlf)<BR>MessageBox 
s</SPAN></SPAN></P>
<P><SPAN style="FONT-SIZE: 13.5pt"><SPAN 
lang=EN-US><o:p></o:p></SPAN></SPAN>&nbsp;</P>
<P><SPAN style="FONT-SIZE: 13.5pt" lang=EN-US>//</SPAN><SPAN 
style="FONT-SIZE: 13.5pt">背景色识别<SPAN lang=EN-US><BR>//</SPAN>比如要识别背景色为白色<SPAN 
lang=EN-US>,</SPAN>文字颜色未知的字形<SPAN lang=EN-US><BR>s = 
lw.Ocr(0,0,2000,2000,"ffffff-000000",0.95,"",1)<BR>MessageBox 
s<BR></SPAN></SPAN>
<HR>

<P></P></DIV></DIV>
<DIV class=footer>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Copyright &copy;2016 <A href="乐玩插件COM版接口说明" 
target=_blank>乐玩网络科技工作室</A>. All Rights Reserved. </P></DIV></BODY></HTML>
