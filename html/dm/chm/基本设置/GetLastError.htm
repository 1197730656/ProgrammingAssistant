<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="GetLastError.files/filelist.xml">
<title>无标题文档</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>User</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>User</o:LastAuthor>
  <o:Revision>169</o:Revision>
  <o:TotalTime>65</o:TotalTime>
  <o:Created>2010-05-26T10:49:00Z</o:Created>
  <o:LastSaved>2019-05-21T05:18:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>261</o:Words>
  <o:Characters>1489</o:Characters>
  <o:Company>Microsoft</o:Company>
  <o:Lines>12</o:Lines>
  <o:Paragraphs>3</o:Paragraphs>
  <o:CharactersWithSpaces>1747</o:CharactersWithSpaces>
  <o:Version>11.6568</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
p
	{mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
p.style2, li.style2, div.style2
	{mso-style-name:style2;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;
	color:blue;
	font-weight:bold;}
span.style21
	{mso-style-name:style21;
	color:blue;
	font-weight:bold;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:普通表格;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
</head>

<body lang=ZH-CN style='tab-interval:21.0pt'>

<div class=Section1>

<p class=style2><span style='font-size:13.5pt'>函数简介<span lang=EN-US>:<o:p></o:p></span></span></p>

<p><span style='font-size:13.5pt'>获取插件命令的最后错误<span lang=EN-US><o:p></o:p></span></span></p>

<p><span class=style21><span style='font-size:13.5pt'>函数原型<span lang=EN-US>:</span></span></span><span
lang=EN-US style='font-size:13.5pt'><br>
<br>
long<span style='mso-spacerun:yes'>&nbsp; </span>GetLastError()<o:p></o:p></span></p>

<p><span class=style21><span style='font-size:13.5pt'>参数定义<span lang=EN-US>:</span></span></span><span
lang=EN-US style='font-size:13.5pt'><o:p></o:p></span></p>

<p><span class=style21><span style='font-size:13.5pt'>返回值<span lang=EN-US>:</span></span></span><span
lang=EN-US style='font-size:13.5pt'><o:p></o:p></span></p>

<p><span style='font-size:13.5pt;color:maroon'>整形数<span lang=EN-US>:<br>
</span></span><span style='font-size:13.5pt'>返回值表示错误值。<span lang=EN-US> 0</span>表示无错误<span
lang=EN-US>.<span style='color:maroon'><o:p></o:p></span></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>-1 : </span><span
style='font-size:13.5pt'>表示你使用了绑定里的收费功能，但是没注册，无法使用<span lang=EN-US>.<br>
-2 : </span>使用模式<span lang=EN-US>0 2 </span>时出现，因为目标窗口有保护<span lang=EN-US>. </span>常见于<span
lang=EN-US>win7</span>以上系统<span lang=EN-US>.</span>或者有安全软件拦截插件<span lang=EN-US
style='color:fuchsia'>.</span><span style='color:fuchsia'>解决办法<span lang=EN-US>:
</span>关闭所有安全软件，然后再重新尝试<span lang=EN-US>. </span>如果还不行就可以肯定是目标窗口有特殊保护<span
lang=EN-US>. </span></span><span lang=EN-US><br>
-3 : </span>使用模式<span lang=EN-US>0 2 </span>时出现，可能目标窗口有保护，也可能是异常错误<span
lang=EN-US>. </span>可以尝试换绑定模式或许可以解决<span lang=EN-US>.<br>
-4 : </span>使用模式<span lang=EN-US>101 103</span>时出现，这是异常错误<span lang=EN-US>.<br>
-5 : </span>使用模式<span lang=EN-US>101 103</span>时出现<span lang=EN-US>, </span>这个错误的解决办法就是关闭目标窗口，重新打开再绑定即可<span
lang=EN-US>. </span>也可能是运行脚本的进程没有管理员权限<span lang=EN-US>. <br>
<span style='color:fuchsia'>-6 : </span></span><span style='color:fuchsia'>被安全软件拦截。
典型的是金山<span lang=EN-US>.360</span>等<span lang=EN-US>. </span>如果是<span
lang=EN-US>360</span>关闭即可。 如果是金山，必须卸载，关闭是没用的<span lang=EN-US>.<br>
</span></span><span lang=EN-US>-7 -9 : </span>使用模式<span lang=EN-US>101 103</span>时出现<span
lang=EN-US>,</span>异常错误<span lang=EN-US>. </span>还有可能是安全软件的问题，比如<span
lang=EN-US>360</span>等。尝试卸载<span lang=EN-US>360.<br>
-8 -10 : </span>使用模式<span lang=EN-US>101 103</span>时出现<span lang=EN-US>, </span>目标进程可能有保护<span
lang=EN-US>,</span>也可能是插件版本过老，试试新的或许可以解决<span lang=EN-US>. <span
style='color:fuchsia'>-8</span></span><span style='color:fuchsia'>可以尝试使用<span
lang=EN-US>DmGuard</span>中的<span lang=EN-US>np2</span>盾配合</span><span
lang=EN-US>.<br>
-11 : </span>使用模式<span lang=EN-US>101 103</span>时出现<span lang=EN-US>, </span>目标进程有保护<span
lang=EN-US>. </span>告诉我解决。<span lang=EN-US><br>
-12 : </span>使用模式<span lang=EN-US>101 103</span>时出现<span lang=EN-US>, </span>目标进程有保护<span
lang=EN-US>. </span>告诉我解决。<span lang=EN-US><br>
-13 : </span>使用模式<span lang=EN-US>101 103</span>时出现<span lang=EN-US>, </span>目标进程有保护<span
lang=EN-US>. </span>或者是因为上次的绑定没有解绑导致。 尝试在绑定前调用<span lang=EN-US>ForceUnBindWindow.
<br>
-14 : </span>可能系统缺少部分<span lang=EN-US>DLL,</span>尝试安装<span lang=EN-US>d3d. </span>或者是鼠标或者键盘使用了<span
lang=EN-US>dx.mouse.api</span>或者<span lang=EN-US>dx.keypad.api</span>，但实际系统没有插鼠标和键盘<span
lang=EN-US>. </span>也有可能是图色中有<span lang=EN-US>dx.graphic.3d</span>之类的<span
lang=EN-US>,</span>但相应的图色被占用<span lang=EN-US>,</span>比如全屏<span lang=EN-US>D3D</span>程序<span
lang=EN-US>.<br>
-16 : </span>可能使用了绑定模式<span lang=EN-US> 0 </span>和<span lang=EN-US> 101</span>，然后可能指定了一个子窗口<span
lang=EN-US>.</span>导致不支持<span lang=EN-US>.</span>可以换模式<span lang=EN-US>2</span>或者<span
lang=EN-US>103</span>来尝试<span lang=EN-US>. </span>另外也可以考虑使用父窗口或者顶级窗口<span
lang=EN-US>.</span>来避免这个错误。还有可能是目标窗口没有正常解绑 然后再次绑定的时候<span lang=EN-US>.<br>
-17 : </span>模式<span lang=EN-US>101 103</span>时出现<span lang=EN-US>. </span>这个是异常错误<span
lang=EN-US>. </span>告诉我解决<span lang=EN-US>.<br>
-18 : </span>句柄无效<span lang=EN-US>.<br>
-19 : </span>使用模式<span lang=EN-US>0 11 101</span>时出现<span lang=EN-US>,</span>这是异常错误<span
lang=EN-US>,</span>告诉我解决<span lang=EN-US>.<br>
-20 : </span>使用模式<span lang=EN-US>101 103 </span>时出现<span lang=EN-US>,</span>说明目标进程里没有解绑，并且子绑定达到了最大<span
lang=EN-US>. </span>尝试在返回这个错误时，调用<span lang=EN-US>ForceUnBindWindow</span>来强制解除绑定<span
lang=EN-US>.<br>
-21 : </span>使用模式<span lang=EN-US>101 103 </span>时出现<span lang=EN-US>,</span>说明目标进程里没有解绑<span
lang=EN-US>. </span>尝试在返回这个错误时，调用<span lang=EN-US>ForceUnBindWindow</span>来强制解除绑定<span
lang=EN-US>.<br>
-22 : </span>使用模式<span lang=EN-US>0 2,</span>绑定<span lang=EN-US>64</span>位进程窗口时出现<span
lang=EN-US>,</span>因为安全软件拦截插件释放的<span lang=EN-US>EXE</span>文件导致<span
lang=EN-US>.<br>
-23 : </span>使用模式<span lang=EN-US>0 2,</span>绑定<span lang=EN-US>64</span>位进程窗口时出现<span
lang=EN-US>,</span>因为安全软件拦截插件释放的<span lang=EN-US>DLL</span>文件导致<span
lang=EN-US>.<br>
-24 : </span>使用模式<span lang=EN-US>0 2,</span>绑定<span lang=EN-US>64</span>位进程窗口时出现<span
lang=EN-US>,</span>因为安全软件拦截插件运行释放的<span lang=EN-US>EXE.<br>
-25 : </span>使用模式<span lang=EN-US>0 2,</span>绑定<span lang=EN-US>64</span>位进程窗口时出现<span
lang=EN-US>,</span>因为安全软件拦截插件运行释放的<span lang=EN-US>EXE.<br>
-26 : </span>使用模式<span lang=EN-US>0 2,</span>绑定<span lang=EN-US>64</span>位进程窗口时出现<span
lang=EN-US>, </span>因为目标窗口有保护<span lang=EN-US>. </span>常见于<span lang=EN-US>win7</span>以上系统<span
lang=EN-US>.</span>或者有安全软件拦截插件<span lang=EN-US style='color:fuchsia'>.</span><span
style='color:fuchsia'>解决办法<span lang=EN-US>: </span>关闭所有安全软件，然后再重新尝试<span
lang=EN-US>. </span>如果还不行就可以肯定是目标窗口有特殊保护<span lang=EN-US>.<br>
</span></span><span lang=EN-US>-27 : </span>绑定<span lang=EN-US>64</span>位进程窗口时出现，因为使用了不支持的模式，目前暂时只支持模式<span
lang=EN-US>0 2 11 13 101 103<br>
-28 : </span>绑定<span lang=EN-US>32</span>位进程窗口时出现，因为使用了不支持的模式，目前暂时只支持模式<span
lang=EN-US>0 2 11 13 101 103<o:p></o:p></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>-100 : </span><span
style='font-size:13.5pt'>调用读写内存函数后，发现无效的窗口句柄<span lang=EN-US><br>
-101 : </span>读写内存函数失败<span lang=EN-US><br>
-200 : AsmCall</span>失败<span lang=EN-US><o:p></o:p></span></span></p>

<p><span class=style21><span style='font-size:13.5pt'>示例<span lang=EN-US>:</span></span></span><span
lang=EN-US style='font-size:13.5pt'><o:p></o:p></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>TracePrint dm.GetLastError()<br
style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p><span style='font-size:13.5pt;color:fuchsia'>注<span lang=EN-US>: </span>此函数必须紧跟上一句函数调用，中间任何的语句调用都会改变这个值<span
lang=EN-US>.<o:p></o:p></span></span></p>

<p><span lang=EN-US style='font-size:13.5pt'>&nbsp;<o:p></o:p></span></p>

</div>

</body>

</html>
