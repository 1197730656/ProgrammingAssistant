<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML xmlns:o = "urn:schemas-microsoft-com:office:office" xmlns:st1 = 
"urn:schemas-microsoft-com:office:smarttags"><HEAD><TITLE>FindColoRLump</TITLE>
<META content="text/html; charset=gb2312" http-equiv=Content-Type>
<META name=GENERATOR content="MSHTML 8.00.7600.17267"><LINK rel=stylesheet 
href="_template.css"></HEAD>
<BODY>
<DIV id=nsbanner>
<DIV id=bannerrow1>
<TABLE class=bannerparthead>
  <TBODY>
  <TR id=hdr>
    <TD class=runninghead noWrap>乐玩插件接口说明 v7.799</TD></TR></TBODY></TABLE></DIV>
<DIV id=titlerow>
<H1 class=dtH1><FONT size=4>FindColorBlock</FONT></H1></DIV></DIV>
<BLOCKQUOTE style="MARGIN-RIGHT: 0px" dir=ltr>
  <DIV align=left>
  <DIV class=Section1><SPAN style="FONT-SIZE: 13.5pt">
  <P class=style1><SPAN style="FONT-SIZE: 13.5pt"><FONT 
  color=#0000ff><STRONG>函数简介<SPAN 
  lang=EN-US>:<o:p></o:p></SPAN></STRONG></FONT></SPAN></P>
  <P class=style1></SPAN><SPAN style="FONT-SIZE: 13.5pt"><SPAN 
  style="FONT-SIZE: 13.5pt">查找指定区域内的颜色块，</SPAN>返回最多的出现次数。<FONT 
  color=#ff0000>本函数会设置x,y。</FONT></SPAN></P>
  <P class=style1><SPAN style="FONT-SIZE: 13.5pt"></SPAN>&nbsp;</P>
  <P><SPAN class=style11><SPAN style="FONT-SIZE: 13.5pt"><STRONG><FONT 
  color=#0000ff>函数原型<SPAN lang=EN-US>:</SPAN></FONT></STRONG></SPAN></SPAN><SPAN 
  style="FONT-SIZE: 13.5pt" lang=EN-US><BR><BR>int&nbsp; 
  FindColorBlock(x1,y1,x2,y2,w,h,color,sim,<SPAN style="FONT-SIZE: 13.5pt"><SPAN 
  lang=EN-US>countModel,<SPAN style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US><SPAN 
  lang=EN-US><FONT color=#000000>color<SPAN style="FONT-SIZE: 13.5pt"><SPAN 
  lang=EN-US>Count,<SPAN style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US><SPAN 
  lang=EN-US><FONT color=#000000><SPAN style="FONT-SIZE: 13.5pt"><SPAN 
  lang=EN-US><SPAN lang=EN-US><SPAN style="FONT-SIZE: 13.5pt"><SPAN 
  lang=EN-US><FONT color=#ff0000><SPAN style="FONT-SIZE: 13.5pt"><SPAN 
  lang=EN-US><SPAN style="FONT-SIZE: 13.5pt" lang=EN-US><SPAN lang=EN-US><FONT 
  color=#000000></FONT><FONT 
  color=#000000>pointModel</FONT></SPAN></SPAN></SPAN></SPAN></FONT></SPAN></SPAN></SPAN></SPAN></SPAN></FONT></SPAN></SPAN></SPAN></SPAN></SPAN></FONT></SPAN></SPAN></SPAN></SPAN></SPAN>)<o:p></o:p></SPAN></P>
  <P><SPAN class=style11><SPAN style="FONT-SIZE: 13.5pt"><STRONG><FONT 
  color=#0000ff>参数定义<SPAN lang=EN-US>:</SPAN></FONT></STRONG></SPAN></SPAN><SPAN 
  style="FONT-SIZE: 13.5pt" lang=EN-US><BR><BR>x1 </SPAN><SPAN 
  style="COLOR: maroon; FONT-SIZE: 13.5pt">整形数</SPAN><SPAN 
  style="FONT-SIZE: 13.5pt" lang=EN-US>:查找区域的左上角X坐标。</SPAN></P>
  <P><SPAN style="FONT-SIZE: 13.5pt" lang=EN-US></SPAN><SPAN 
  style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US>y1 </SPAN><SPAN 
  style="COLOR: maroon">整形数</SPAN><SPAN 
  lang=EN-US>:查找区域的左上角Y坐标。</SPAN></SPAN></P>
  <P><SPAN style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US>x2 <SPAN 
  style="COLOR: maroon; FONT-SIZE: 13.5pt">整形数</SPAN><SPAN 
  style="FONT-SIZE: 13.5pt" lang=EN-US>:查找区域的右下角X坐标。</SPAN></P>
  <P><SPAN style="FONT-SIZE: 13.5pt" lang=EN-US></SPAN><SPAN 
  style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US>y2 </SPAN><SPAN 
  style="COLOR: maroon">整形数</SPAN><SPAN 
  lang=EN-US>:查找区域的右下角Y坐标。</SPAN></SPAN></P>
  <P><SPAN style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US>w <SPAN 
  style="COLOR: maroon">整形数</SPAN><SPAN 
  lang=EN-US>:要在多大的一块矩形区域中统计颜色，这里设置矩形宽度。</SPAN></SPAN></SPAN></P>
  <P><SPAN style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US><SPAN 
  lang=EN-US></SPAN></SPAN></SPAN><SPAN style="FONT-SIZE: 13.5pt"><SPAN 
  lang=EN-US>h&nbsp; <SPAN style="COLOR: maroon">整形数</SPAN><SPAN 
  lang=EN-US>:要在多大的一块矩形区域中统计颜色，这里设置矩形高度。</SPAN></SPAN></SPAN></P>
  <P style="MARGIN-RIGHT: 0px" dir=ltr><SPAN style="FONT-SIZE: 13.5pt"><SPAN 
  lang=EN-US><SPAN lang=EN-US></SPAN></SPAN></SPAN><SPAN 
  style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US>color <FONT 
  color=#808080>字符串</FONT>：要统计的颜色，要统计的颜色，格式为"RRGGBB-DRDGDB",比如"123456-000000|aabbcc-&nbsp; 
  202020".注意，这里只支持RGB颜色.</SPAN></SPAN></P><SPAN style="FONT-SIZE: 13.5pt"><SPAN 
  lang=EN-US>
  <P><SPAN style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US>sim <SPAN 
  style="COLOR: #339966; FONT-SIZE: 13.5pt"><SPAN 
  style="COLOR: #339966">小数型</SPAN></SPAN><SPAN style="FONT-SIZE: 13.5pt" 
  lang=EN-US>:要统计的颜色的相似度，取值范围0－1。<FONT 
  color=#ff0000>该参数的缺省值为0.95。</FONT></SPAN></SPAN></SPAN></P></SPAN></SPAN>
  <P style="MARGIN-RIGHT: 0px" dir=ltr><SPAN style="FONT-SIZE: 13.5pt"><SPAN 
  lang=EN-US>countModel&nbsp; <SPAN style="COLOR: maroon">整形数</SPAN><SPAN 
  lang=EN-US>:0＝当有多个区域颜色数量一样时，返回最左上角的区域；1＝当有多个区域颜色数量一样时，返回最右下角的区域；2＝当区域内的颜色数量大于等于<SPAN 
  style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US><SPAN lang=EN-US><FONT 
  color=#000000>color<SPAN style="FONT-SIZE: 13.5pt"><SPAN 
  lang=EN-US>Count&nbsp;</SPAN></SPAN></FONT></SPAN></SPAN></SPAN>参数的值时，立刻返回，如果没找到符合条件的区域，返回0。<FONT 
  color=#ff0000>该参数的缺省值为0。</FONT></SPAN></SPAN></SPAN></P>
  <P style="MARGIN-RIGHT: 0px" dir=ltr><SPAN style="FONT-SIZE: 13.5pt"><SPAN 
  lang=EN-US><SPAN lang=EN-US><FONT color=#000000>color<SPAN 
  style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US>Count&nbsp; <SPAN 
  style="COLOR: maroon">整形数</SPAN><SPAN lang=EN-US>:&nbsp; 颜色数量，仅当<SPAN 
  style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US>countModel为2时有效。<FONT 
  color=#ff0000>该参数的缺省值为0。<SPAN style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US><SPAN 
  style="FONT-SIZE: 13.5pt" lang=EN-US><SPAN lang=EN-US><FONT 
  color=#000000>(</FONT></SPAN><SPAN style="COLOR: fuchsia">注意<SPAN 
  lang=EN-US>,</SPAN>这个颜色数量可以在综合工具的二值化区域中看到</SPAN><SPAN lang=EN-US><FONT 
  color=#000000>)</FONT></SPAN></SPAN></SPAN></SPAN></FONT></SPAN></SPAN></SPAN></SPAN></SPAN></FONT></SPAN></SPAN></SPAN></P>
  <P style="MARGIN-RIGHT: 0px" dir=ltr><SPAN style="FONT-SIZE: 13.5pt"><SPAN 
  lang=EN-US><SPAN lang=EN-US><FONT color=#000000><SPAN 
  style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US><SPAN lang=EN-US><SPAN 
  style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US><FONT color=#ff0000><SPAN 
  style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US><SPAN style="FONT-SIZE: 13.5pt" 
  lang=EN-US><SPAN lang=EN-US><FONT color=#000000></FONT><FONT 
  color=#000000>pointModel&nbsp; <SPAN style="COLOR: maroon">整形数</SPAN><SPAN 
  lang=EN-US>:&nbsp; 
  坐标的返回模式，0=如果找到，保证返回的坐标颜色是统计颜色；1=返回色块的左上角坐标；2＝返回色块的中心点坐标；3＝返回色块的右下角坐标。<FONT 
  color=#ff0000>该参数的缺省值为0。</FONT></SPAN></FONT></P></SPAN></SPAN></SPAN></SPAN></FONT></SPAN></SPAN></SPAN></SPAN></SPAN></FONT></SPAN></SPAN></SPAN>
  <P><SPAN style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US><SPAN 
  style="FONT-SIZE: 13.5pt" lang=EN-US><SPAN 
  lang=EN-US></SPAN>&nbsp;</P></SPAN></SPAN></SPAN></SPAN></SPAN>
  <P><STRONG><FONT color=#0000ff><SPAN class=style11><SPAN 
  style="FONT-SIZE: 13.5pt">返回值<SPAN lang=EN-US>:</SPAN></SPAN></SPAN><SPAN 
  style="FONT-SIZE: 13.5pt" lang=EN-US><o:p></o:p></SPAN></FONT></STRONG></P>
  <P><SPAN style="COLOR: gray; FONT-SIZE: 13.5pt"><SPAN 
  style="COLOR: maroon">整形数</SPAN></SPAN></P>
  <P><SPAN class=style11><SPAN style="FONT-SIZE: 13.5pt"><FONT 
  color=#000000>返回指定颜色出现的最多次数。</FONT></SPAN></SPAN></P>
  <P><STRONG><FONT color=#0000ff><SPAN class=style11><SPAN 
  style="FONT-SIZE: 13.5pt"></SPAN></SPAN></FONT></STRONG>&nbsp;</P>
  <P><STRONG><FONT color=#0000ff><SPAN class=style11><SPAN 
  style="FONT-SIZE: 13.5pt">示例<SPAN lang=EN-US>:</SPAN></SPAN></SPAN><SPAN 
  style="FONT-SIZE: 13.5pt" lang=EN-US><o:p></o:p></SPAN></FONT></STRONG></P>
  <P><SPAN style="FONT-SIZE: 13.5pt" 
  lang=EN-US>ret=lw.FindColorBlock(0,0,2000,2000,47,47,"ff0000",1)</SPAN></P>
  <P><SPAN style="FONT-SIZE: 13.5pt" lang=EN-US>if ret&gt;0 
&nbsp;then</SPAN></P>
  <P><SPAN style="FONT-SIZE: 13.5pt" lang=EN-US>&nbsp;TracePrint 
  “红色在大小为47*47的矩形内，出现的最多次数为“&amp;ret&amp;"该矩形的左上角坐标为："&amp;lw.x&amp;lw.Y。</SPAN></P>
  <P><SPAN style="FONT-SIZE: 13.5pt" lang=EN-US></SPAN><SPAN 
  style="FONT-SIZE: 13.5pt" lang=EN-US>end if </P></DIV></DIV>
  <P class=Section1><SPAN style="FONT-SIZE: 13.5pt"><SPAN 
  lang=EN-US><o:p>//TC等其它语言要用 lw.x(),lw.y()</o:p></SPAN></SPAN></SPAN></P>
  <DIV align=left><FONT size=4><FONT 
  color=#ff0000>该函数的实现原理为，截取绑定窗口的x1,y1,x2,y2区域的图像，然后从起点开始，逐点统计w,h大小的矩形区域内<SPAN 
  style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US>color的出现次数，最终的返回值为<SPAN 
  style="FONT-SIZE: 13.5pt"><SPAN 
  lang=EN-US>color在某个矩形区域内出现的最多的次数，该矩形区域的左上角坐标设置在对象的X，Y变量内。</SPAN></SPAN></SPAN></SPAN></FONT></FONT></DIV></BLOCKQUOTE>
<DIV align=left>&nbsp;</DIV>
<DIV align=left>
<HR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Copyright &copy;2017 <A href="乐玩插件COM版接口说明" 
target=_blank>乐玩网络科技工作室</A>. All Rights Reserved. </DIV></BODY></HTML>
