<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML xmlns:o = "urn:schemas-microsoft-com:office:office" xmlns:st1 = 
"urn:schemas-microsoft-com:office:smarttags"><HEAD><TITLE>FindStr</TITLE>
<META content="text/html; charset=gb2312" http-equiv=Content-Type>
<META name=GENERATOR content="MSHTML 10.00.9200.17088"><LINK rel=stylesheet 
href="_template.css"></HEAD>
<BODY>
<DIV id=nsbanner>
<DIV id=bannerrow1>
<TABLE class=bannerparthead>
  <TBODY>
  <TR id=hdr>
    <TD class=runninghead noWrap>乐玩插件接口说明 v7.27111</TD></TR></TBODY></TABLE></DIV>
<DIV id=titlerow>
<H1 class=dtH1>FindStr</H1></DIV></DIV>
<DIV id=nstext><BR>
<DIV class=Section1><SPAN style="FONT-SIZE: 13.5pt">
<P class=style1><SPAN style="FONT-SIZE: 13.5pt"><FONT 
color=#0000ff><STRONG>函数简介<SPAN 
lang=EN-US>:<o:p></o:p></SPAN></STRONG></FONT></SPAN></P>
<P class=style1></SPAN><SPAN style="FONT-SIZE: 13.5pt">同<SPAN 
lang=EN-US>FindStr</SPAN>。<SPAN lang=EN-US><o:p></o:p></SPAN></SPAN></P>
<P><SPAN class=style11><SPAN style="FONT-SIZE: 13.5pt"><STRONG><FONT 
color=#0000ff>函数原型<SPAN lang=EN-US>:</SPAN></FONT></STRONG></SPAN></SPAN><SPAN 
lang=EN-US 
style="FONT-SIZE: 13.5pt"><BR><BR>int&nbsp;FindStrFast(x1,y1,x2,y2,string,color_format,sim,isbackcolor)</SPAN></P>
<P><SPAN lang=EN-US style="FONT-SIZE: 13.5pt"><o:p></o:p></SPAN><SPAN 
class=style11><SPAN style="FONT-SIZE: 13.5pt"><STRONG><FONT 
color=#0000ff>参数定义<SPAN lang=EN-US>:</SPAN></FONT></STRONG></SPAN></SPAN><SPAN 
lang=EN-US style="FONT-SIZE: 13.5pt"><BR>x1 <SPAN 
style="FONT-SIZE: 13.5pt; COLOR: maroon">整形数</SPAN><SPAN lang=EN-US 
style="FONT-SIZE: 13.5pt">:</SPAN><SPAN style="FONT-SIZE: 13.5pt">区域的左上<SPAN 
lang=EN-US>X</SPAN>坐标<SPAN lang=EN-US><BR>y1 </SPAN><SPAN 
style="COLOR: maroon">整形数</SPAN><SPAN lang=EN-US>:</SPAN>区域的左上<SPAN 
lang=EN-US>Y</SPAN>坐标<SPAN lang=EN-US><BR>x2 </SPAN><SPAN 
style="COLOR: maroon">整形数</SPAN><SPAN lang=EN-US>:</SPAN>区域的右下<SPAN 
lang=EN-US>X</SPAN>坐标<SPAN lang=EN-US><BR>y2 </SPAN><SPAN 
style="COLOR: maroon">整形数</SPAN><SPAN lang=EN-US>:</SPAN>区域的右下<SPAN 
lang=EN-US>Y</SPAN>坐标<SPAN lang=EN-US><BR>string </SPAN><SPAN 
style="COLOR: gray">字符串</SPAN><SPAN lang=EN-US>:</SPAN><SPAN 
class=GramE>待查找</SPAN>的字符串<SPAN lang=EN-US>,</SPAN>可以是字符串组合，比如<SPAN 
lang=EN-US>"</SPAN>长安<SPAN lang=EN-US>|</SPAN>洛阳<SPAN 
lang=EN-US>|</SPAN>大雁塔<SPAN lang=EN-US>",</SPAN>中间用<SPAN 
lang=EN-US>"|"</SPAN>来分割字符串<SPAN lang=EN-US><BR><SPAN class=SpellE><SPAN 
lang=EN-US><SPAN class=SpellE>color_format <SPAN 
style="COLOR: gray">字符串</SPAN><SPAN 
lang=EN-US>:</SPAN>颜色格式串,有两种格式：</SPAN></SPAN></P>
<P><SPAN style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US><SPAN class=SpellE><SPAN 
style="FONT-SIZE: 13.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
1，直接写RGB色加-RGB色偏，如“9f2e3f-030303|2d3f2f-000000"，支持多个。</SPAN></P>
<P><SPAN 
style="FONT-SIZE: 13.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2，#后面加数值，如“#128”，表示采用灰度阀值二值化，值的取值范围为-6到510，只能设置1个。<SPAN 
style="FONT-SIZE: 13.5pt">具体可用工具测试。</SPAN></P>
<P></SPAN></SPAN></SPAN></SPAN></SPAN></SPAN><SPAN lang=EN-US><SPAN 
class=SpellE>sim</SPAN> </SPAN><SPAN style="COLOR: #339966"><SPAN 
style="COLOR: #339966">小数型</SPAN></SPAN><SPAN lang=EN-US>:</SPAN>相似度<SPAN 
lang=EN-US>,</SPAN>取值范围<SPAN lang=EN-US>0.1-1.0　<FONT 
color=#ff0000>此参数的缺省值为0.95<BR></FONT></SPAN></SPAN></P>
<P><FONT color=#0000ff><SPAN class=style11><SPAN 
style="FONT-SIZE: 13.5pt"><STRONG><FONT color=#000000>isbackcolor <FONT 
color=#800000>整数型</FONT>:是否背景色,为1表示</FONT></STRONG><FONT color=#000000><SPAN 
class=SpellE>color_format</SPAN> 所提供的颜色为背景色,否则表示提供的为文字颜色.</FONT><FONT 
color=#ff0000>此参数的缺省值为0</FONT></SPAN></SPAN></FONT></P>
<P><STRONG><FONT color=#0000ff><SPAN class=style11><SPAN 
style="FONT-SIZE: 13.5pt">返回值<SPAN lang=EN-US>:</SPAN></SPAN></SPAN><SPAN 
lang=EN-US style="FONT-SIZE: 13.5pt"><o:p></o:p></SPAN></FONT></STRONG></P>
<P><SPAN style="FONT-SIZE: 13.5pt; COLOR: maroon">整形数<SPAN 
lang=EN-US>:</SPAN></SPAN><SPAN lang=EN-US 
style="FONT-SIZE: 13.5pt"><BR></SPAN></P>
<P><STRONG><SPAN class=style11><SPAN style="FONT-SIZE: 13.5pt"><FONT 
color=#000000>找到返回1,没找到返回0</FONT></SPAN></SPAN></STRONG></P>
<P><SPAN lang=EN-US 
style="FONT-SIZE: 13.5pt"><o:p>&nbsp;</o:p></SPAN></P></SPAN><SPAN lang=EN-US 
style="FONT-SIZE: 13.5pt"><o:p>
<P><STRONG><FONT color=#0000ff><SPAN class=style11><SPAN 
style="FONT-SIZE: 13.5pt">示例<SPAN lang=EN-US>:</SPAN></SPAN></SPAN><SPAN 
lang=EN-US style="FONT-SIZE: 13.5pt"><o:p></o:p></SPAN></FONT></STRONG></P><SPAN 
lang=EN-US style="FONT-SIZE: 13.5pt">
<P><FONT color=#ff0000>TC例子：</FONT></P>
<P><SPAN class=SpellE>ret</SPAN> = <SPAN 
class=SpellE>lw.FindStrFast</SPAN>(0,0,2000,2000,"</SPAN><SPAN 
style="FONT-SIZE: 13.5pt">长安|洛阳<SPAN lang=EN-US>","<st1:chmetcnv UnitName="F" 
SourceValue="9" HasSpace="False" Negative="False" NumberType="1" TCSC="0" 
w:st="on">9f</st1:chmetcnv>2e<st1:chmetcnv UnitName="F" SourceValue="3" 
HasSpace="False" Negative="False" NumberType="1" TCSC="0" 
w:st="on">3f</st1:chmetcnv>-000000",1.0)<BR>If&nbsp;<SPAN 
class=SpellE>ret=1</SPAN> Then<BR><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN 
class=SpellE>lw.MoveTo(</SPAN>lw.x(),lw.y())</SPAN></SPAN></P>
<P><SPAN style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US></SPAN></SPAN><SPAN 
style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US>End If</SPAN></SPAN></P>
<P><SPAN style="FONT-SIZE: 13.5pt"><SPAN 
lang=EN-US><o:p></o:p></SPAN></SPAN>&nbsp;</P>
<P><FONT color=#ff0000>按键例子：</FONT></P>
<P><SPAN class=SpellE>ret</SPAN> = <SPAN 
class=SpellE>lw.FindStrFast</SPAN>(0,0,2000,2000,"<SPAN 
style="FONT-SIZE: 13.5pt">长安|洛阳<SPAN lang=EN-US>","<st1:chmetcnv UnitName="F" 
SourceValue="9" HasSpace="False" Negative="False" NumberType="1" TCSC="0" 
w:st="on">9f</st1:chmetcnv>2e<st1:chmetcnv UnitName="F" SourceValue="3" 
HasSpace="False" Negative="False" NumberType="1" TCSC="0" 
w:st="on">3f</st1:chmetcnv>-000000",1.0)<BR>If&nbsp;<SPAN 
class=SpellE>ret=1</SPAN> Then<BR><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN 
class=SpellE>lw.MoveTo </SPAN>lw.x,lw.y</SPAN></SPAN></P>
<P><SPAN style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US></SPAN></SPAN><SPAN 
style="FONT-SIZE: 13.5pt"><SPAN lang=EN-US>End 
If</SPAN></SPAN>&nbsp;</o:p></SPAN></P>
<P><SPAN style="FONT-SIZE: 13.5pt; COLOR: fuchsia">注<SPAN lang=EN-US>: 
</SPAN>此函数比<SPAN lang=EN-US>FindStr</SPAN>要快很多，尤其是在字库很大时，或者模糊识别时，效果非常明显。<SPAN 
lang=EN-US><BR></SPAN>推荐使用此函数。<SPAN 
lang=EN-US><BR></SPAN>另外由于此函数是只识别待查找的字符，所以可能会有如下情况出现问题。<SPAN 
lang=EN-US><o:p></o:p></SPAN></SPAN></P>
<P><SPAN style="FONT-SIZE: 13.5pt; COLOR: fuchsia">比如 字库中有<SPAN 
lang=EN-US>"</SPAN>张和三<SPAN lang=EN-US>" </SPAN>一共<SPAN 
lang=EN-US>3</SPAN>个字符数据，然后待识别区域里是<SPAN lang=EN-US>"</SPAN>张和三<SPAN 
lang=EN-US>",</SPAN>如果用<SPAN lang=EN-US>FindStr</SPAN>查找<SPAN 
lang=EN-US><BR>"</SPAN>张三<SPAN lang=EN-US>"</SPAN>肯定是找不到的，但是用<SPAN 
lang=EN-US>FindStrFast</SPAN>却可以找到，因为<SPAN lang=EN-US>"</SPAN>和<SPAN 
lang=EN-US>"</SPAN>这个字符没有列入查找计划中<SPAN 
lang=EN-US><BR></SPAN>所以，在使用此函数时，也要特别注意这一点。<SPAN 
lang=EN-US><o:p></o:p></SPAN></SPAN></P></DIV>
<HR>
</DIV>
<DIV class=footer>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Copyright &copy;2016 <A href="乐玩插件COM版接口说明" 
target=_blank>乐玩网络科技工作室</A>. All Rights Reserved. </P></DIV></BODY></HTML>
